# 流程化编程
### 本质
利用编译期对类的加载编一定的流程，流程固化
### 1.初始化流程 - 加载阶段
```java
public class Stepfactory {
    private static final List<Step> beforeSteps = new LinkedList<>();
    private static final List<Step> afterSteps = new LinkedList<>();
    static {

        beforeSteps.add(new StartStep());
        beforeSteps.add(new EnvCheckStep());
        beforeSteps.add(new MatcherCacheStep());
        beforeSteps.add(new GetMockInfoStep());
        beforeSteps.add(new CheckResultStep());
        beforeSteps.add(new DealSleepStep());
        beforeSteps.add(new DealExceptionStep());
        beforeSteps.add(new DealJsonResultStep());

        afterSteps.add(new AfterEnvCheckStep());
        afterSteps.add(new CollectFilterStep());
        afterSteps.add(new CollectStep());
    }

}
```

### 2.流程化调用并组织先后顺序 - 抽象类
```java
public abstract class Step {
    protected static final Logger logger = LoggerFactory.getLogger(Step.class);

    public abstract String getStepName();

    public abstract void beforeStep(MockContext mockContext);

    public abstract void execStep(MockContext mockContext);

    public abstract void afterStep(MockContext mockContext);

    public void flowStep(MockContext mockContext){
        addStepLog();
        beforeStep(mockContext);
        execStep(mockContext);
        afterStep(mockContext);
    }

    public void addStepLog(){
        logger.debug(getStepName());
    }
}
```
